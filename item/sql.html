<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<?xml version="1.0" encoding="Shift_Jis"?><html lang="jp" xml:lang="jp" xmlns="http://www.w3.org/1999/xhtml"><head>
<meta http-equiv="Content-Type" content="text/html; charset=shift_jis">
<meta content="MSHTML 6.00.2900.3636" name="GENERATOR">
	<meta name="author" content="Wink Hosting (www.winkhosting.com)" /> 
	<meta http-equiv="Content-Type" content="text/html; charset=Shift_JIS" /> 
	<meta name="keywords" content="SQL Server Express,RDB,Java,ソフトハウス,プログラマ,SE" /> 
	<meta name="description" content="SQL Server Express 2008のインストール | 技術情報" /> 
	<meta http-equiv="Content-Style-Type" content="text/css" /> 
	<link rel="stylesheet" href="../images/style.css" type="text/css" /> 

</head>
<body>


	<div id="page" align="center"> 
		<div id="content" style="width:800px"> 
			<div id="logo"> 
				<div style="margin-top:70px" class="whitetitle">IPlanning</div> 
			</div> 
			<div id="topheader"> 
				<div align="left" class="infotext"> 
					<br /> 
					<h1>株式会社 アイプランニング</h1><br /> 
					Towa Edogawabashi building 8F<br /> 
					Yamabuki-cho 347<br /> 
					Shinjuku-ku Tokyo<br /> 
					Phone: 03-5225-1147<br /> 
				</div> 
				<div id="toplinks" class="smallgraytext"> 
					<a href="../index.html">HOME</a> | <a href="../privacy/index.html" target="_blank">個人情報保護方針</a> | <a href="../sitemap.html">サイトマップ</a> | <a href="../contact/index.html">問い合わせ</a> 
				</div> 
			</div> 
			<div id="menu"> 
				<div align="right" class="smallwhitetext" style="padding:9px;"> 
					<a href="../index.html">HOME</a> | <a href="../outline/index.html">会社概要</a> | <a href="../policy/index.html">企業理念</a> | <a href="../product/index.html">開発実績</a> | <a href="../map/index.html">所在地(地図)</a> | <a href="../item/index.html">技術情報</a> 
				</div> 
			</div> 
			<div id="submenu"> 
				<div align="right" class="smallgraytext" style="padding:9px;"> 
					<a href="../about/index.html">代表からの挨拶</a> | <a href="../recruit/new.html">新卒募集</a> | <a href="../recruit/tyuto.html">中途募集</a> | <a href="../voice/index.html">社員の声</a> | <a href="../circle/index.html">サークル活動</a> | <a href="../link/index.html">リンク</a> 
				</div> 
			</div> 
			<div id="contenttext"  align="justify"> 
				<div style="padding:70px 10px 15px 0px"> 
					<span class="titletext"><strong>SQL Server 2008 Expressのインストール</strong></span> 
					<p style="padding:8px;font-size:18px;font-weight:bold;text-align:left;line-height:130%;"> 
					SQL Server 2008 Expressのインストール、設定、およびJavaからの利用方法についての資料を公開します。</p> 
				</div> 
<div class="bodytext" style="padding: 12px; align: justify"> 


<p style="margin: 5px 5px 5px 0px;">DBサーバの開発環境作成や、導入検討を行う際には無償版を使うと便利です。<br>
SQL Serverにも無償版が用意されています。</p>
<h2>１．制限事項</h2>
<p style="margin: 5px 5px 5px 0px;">Express(無料版)には、以下の制限があります。<br>
・物理CPUの認識数が一つに制限されている。<br>
・メモリ最大1GBまで<br>
・DBサイズは最大4GBまで</p>
<p style="margin: 5px 5px 5px 0px;">十分な機能を有しているため、<br>
小規模な商用サービスであれば、<br>
Expressで運用しているところも少なくないようです。</p>
<h2>２．SQL Server 2008 Expressのインストール</h2>
<p style="margin: 5px 5px 5px 0px;">インストールには、以下のツールが必要になります。<br>
事前にインストールを行ってください。</p>
<p style="margin: 5px 5px 5px 0px;"><a href="http://www.microsoft.com/downloads/details.aspx?displaylang=ja&amp;FamilyID=5a58b56f-60b6-4412-95b9-54d056d6f9f4">Windows 
Installer 4.5 Redistributable<br>
</a><a href="http://www.microsoft.com/downloads/details.aspx?familyid=AB99342F-5D1A-413D-8319-81DA479AB0D7&amp;displaylang=ja">Microsoft 
.NET Framework 3.5 Service Pack 1</a><br>
<a href="http://www.microsoft.com/windowsserver2003/technologies/management/powershell/download.mspx">Windows 
Power Shell 1.0</a></p>
<p style="margin: 5px 5px 5px 0px;">※注意<br>
MSXML6 SP2が入っている場合、アンインストールを行ってください。<br>
（SQL Server Express 
2008セットアップは、<br>
SP無しのMSXML6のインストールを試みるため、失敗すると<br>
SQL 
Server自体のインストールを中止してしまうようです。）</p>
<p style="margin: 5px 5px 5px 0px;">SQL Server 2008 Express本体は以下からダウンロードします。</p>
<p style="margin: 5px 5px 5px 0px;"><a href="http://www.microsoft.com/downloads/details.aspx?familyid=7522A683-4CB2-454E-B908-E805E9BD4E28&amp;displaylang=ja">http://www.microsoft.com/downloads/details.aspx?familyid=7522A683-4CB2-454E-B908-E805E9BD4E28&amp;displaylang=ja</a></p>
<p style="margin: 5px 5px 5px 0px;">ツールをダウンロードする手間を省くため、ここではwith tools版をダウンロードします。</p>
<p style="margin: 5px 5px 5px 0px;">インストールツールを起動し、ダイアログにしたがってインストールを進めます。</p>
<p style="margin: 5px 5px 5px 0px;"><span class="Apple-style-span" style="WORD-SPACING: 0px; FONT: medium 'MS PGothic'; TEXT-TRANSFORM: none; COLOR: rgb(0,0,0); TEXT-INDENT: 0px; WHITE-SPACE: normal; LETTER-SPACING: normal; BORDER-COLLAPSE: separate; orphans: 2; widows: 2; webkit-border-horizontal-spacing: 0px; webkit-border-vertical-spacing: 0px; webkit-text-decorations-in-effect: none; webkit-text-size-adjust: auto; webkit-text-stroke-width: 0px"><span class="Apple-style-span" style="FONT-SIZE: 14px; COLOR: rgb(51,51,51); LINE-HEIGHT: 21px; FONT-FAMILY: 'ＭＳ ゴシック', monospace; LETTER-SPACING: 1px"><img height="320" alt="" src="install01.png" width="400"></span></span></p>
<p style="margin: 5px 5px 5px 0px;">テスト用のユーザを作成したいので、認証モードを「混合モード(SQL Server認証とWindows認証)」にしてインストールをします。</p>
<p style="margin: 5px 5px 5px 0px;">インストールには１〜２時間ほどかかりました。</p>
<p style="margin: 5px 5px 5px 0px;">インストール後は管理ツールを使って作業を行います。<br>
正常にインストールできていれば、<br>
スタートメニュー＞Microsoft SQL 
Server 2008＞SQL Server Management Studio<br>
から起動できます。</p>
<p style="margin: 5px 5px 5px 0px;"><img height="310" alt="" src="install02.png" width="400"></p>
<p style="margin: 5px 5px 5px 0px;">Windows認証でログインします。</p>
<h2>３．ローカルサーバの設定</h2>
<p style="margin: 5px 5px 5px 0px;">DBを使えるようにするためには、以下の３つの設定を行う必要があります。</p>
<p style="margin: 5px 5px 5px 0px;">(i)DBの作成<br>
(ii)テーブルの作成<br>
(iii)アカウントの追加</p>
<p style="margin: 5px 5px 5px 0px;">順に行っていきましょう。</p>
<p style="margin: 5px 5px 5px 0px;">(i)DBの作成</p>
<p style="margin: 5px 5px 5px 0px;">まず、新しいDBを作成します。</p>
<p style="margin: 5px 5px 5px 0px;"><img height="200" alt="" src="createdb01.png" width="335"></p>
<p style="margin: 5px 5px 5px 0px;">DBのプロパティが開きますので、<br>
データベース名を入力します。</p>
<p style="margin: 5px 5px 5px 0px;"><img height="405" alt="" src="createdb02.png" width="400"></p>
<p style="margin: 5px 5px 5px 0px;">(ii)テーブルの作成</p>
<p style="margin: 5px 5px 5px 0px;">先ほど作成したDBツリーを開き、テーブルを作成します。</p>
<p style="margin: 5px 5px 5px 0px;"><img height="162" alt="" src="createtbl01.png" width="294"></p>
<p style="margin: 5px 5px 5px 0px;">テーブルデザイナが開きます。</p>
<p style="margin: 5px 5px 5px 0px;"><img height="336" alt="" src="tabledesigner.png" width="400"></p>
<p style="margin: 5px 5px 5px 0px;">プロパティ内のテーブル名を登録し、<br>
列名と型を決めていきます。<br>
ここでは、PRODUCT_TBLというテーブル名にしています。</p>
<p style="margin: 5px 5px 5px 0px;">列名と型は以下の通りにしました。</p>
<p style="margin: 5px 5px 5px 0px;">
<table cellspacing="0" cellpadding="0" width="75%" border="1">
  <tbody>
  <tr>
    <td>列名　</td>
    <td>型名</td>
  </tr>
  <tr>
    <td><strong>product_id</strong></td>
    <td><strong>int</strong></td>
  </tr>
  <tr>
    <td><strong>name</strong></td>
    <td><strong>nvarchar(MAX)</strong>（Unicode可変長文字列）</td></tr></tbody></table></p>
<p style="margin: 5px 5px 5px 0px;">まず、商品名を管理するので、nameという列を作成します。<br>
加えて、ユニークなIDを使いたいので、<br>
product_idというintの列を作成しました。</p>
<p style="margin: 5px 5px 5px 0px;">プロパティのIDENTITY列にproduct_idを設定すると、<br>
自動でインクリメント（＋１）してくれます。</p>
<p style="margin: 5px 5px 5px 0px;"><img height="141" alt="" src="createtbl02.png" width="313"></p>
<p style="margin: 5px 5px 5px 0px;">あとは、適当にテスト用のデータを作成しておきます。</p>
<p style="margin: 5px 5px 5px 0px;"><img height="189" alt="" src="edittbl.png" width="327"></p>
<p style="margin: 5px 5px 5px 0px;">テーブルを右クリックして上位200行の編集を選択します。</p>
<p style="margin: 5px 5px 5px 0px;"><img height="156" alt="" src="edittbl02.png" width="316"></p>
<p style="margin: 5px 5px 5px 0px;">product_idはnullのままにして、nameを入れると、<br>
product_idは自動的にインクリメントされます。</p>
<p style="margin: 5px 5px 5px 0px;">(iii)アカウントの作成</p>
<p style="margin: 5px 5px 5px 0px;">DBにアクセスできるアカウントを作成します。</p>
<p style="margin: 5px 5px 5px 0px;">DBのツリーから、セキュリティ＞ログインを右クリックし、<br>
新しいログインを作成します。</p>
<p style="margin: 5px 5px 5px 0px;"><img height="334" alt="" src="createlogin01.png" width="372"></p>
<p style="margin: 5px 5px 5px 0px;">ログインのプロパティが開きます。<br>
ログイン名とパスワードを入力します。種別はSQL Server認証にしてください。</p>
<p style="margin: 5px 5px 5px 0px;"><img height="178" alt="" src="createlogin02.png" width="400"></p>
<p style="margin: 5px 5px 5px 0px;">なお、当環境（Windows XP 
sp2）では、<br>
「ユーザーは次回ログイン時にパスワードを変更する」にチェックを入れていると、<br>
アカウントの作成が出来ませんでした。<br>
Windowsのバージョンによるもののようです。</p>
<p style="margin: 5px 5px 5px 0px;">次に、ユーザにDBを操作する権限を与えます。</p>
<p style="margin: 5px 5px 5px 0px;"><img height="120" alt="" src="createlogin03.png" width="170"><br>
ログインのプロパティから、ユーザマッピングの項を選択します。</p>
<p style="margin: 5px 5px 5px 0px;"><img height="355" alt="" src="createlogin04.png" width="400"></p>
<p style="margin: 5px 5px 5px 0px;">扱いたいDB（ここではtest）にチェックを入れます。<br>
また、db_ownerにチェックを入れます。</p>
<p style="margin: 5px 5px 5px 0px;">これで、ユーザにDBを操作する権限を付与することが出来ました。<br>
以後は、ここで作成したユーザをそれぞれのクライアントから使えばOKです。</p>
<p style="margin: 5px 5px 5px 0px;">&nbsp;</p>
<h2>４．Javaからアクセスする</h2>
<p style="margin: 5px 5px 5px 0px;">TCP/IPからの接続に関しては、<a href="http://gigasmegas.com/?p=599">GigasMegas&nbsp;- SQL 
Server 2008 Express TCP/IP接続設定</a>を参考にしました。<br>
接続は、以下のようなコードで確認することができます。</p>
<p style="margin: 5px 5px 5px 0px;"><textarea style="WIDTH: 400px; HEIGHT: 426px" rows="30" wrap="off" cols="65">public class ConnectStudy {
	public static Connection getConnection() {
		Connection con = null;
		try {
			Class.forName("com.microsoft.sqlserver.jdbc.SQLServerDriver");
			String connectionUrl = "jdbc:sqlserver://localhost:1433;databaseName=test;user=ipl;password=*****;";
			con = DriverManager.getConnection(connectionUrl);
		} catch (ClassNotFoundException e) {
			e.printStackTrace();
		} catch (SQLException e) {
			e.printStackTrace();
		}
		return con;
	}

	public static void main(String[] args) {

		Connection con = getConnection();
		try {
    		String sql = "SELECT TOP 10 * FROM PRODUCT_TBL";
    		Statement stmt = con.createStatement();
    		ResultSet rs = stmt.executeQuery(sql);
    		while (rs.next()) {
    			System.out.println(rs.getString(1) + " " + rs.getString(2));
    		}
		} catch (SQLException e) {
			e.printStackTrace();
		} finally {
			try {
				con.close();
			} catch (SQLException e) {
				e.printStackTrace();
			}
		}

	}
}
</textarea></p>
<p style="margin: 5px 5px 5px 0px;">以上のコードを利用して、簡単な<br>
住所管理アプリケーションをJava(Swing)で作成しました。</p>
<p style="margin: 5px 5px 5px 0px;"><img height="208" alt="" src="sampleapp0.png" width="300"></p>
<p style="margin: 5px 5px 5px 0px;"><img height="418" alt="" src="sampleapp1.png" width="300"></p>
<p style="margin: 5px 5px 5px 0px;">このような小規模なアプリケーションであれば、簡単に作れることが分かりました。<br>
さすがにインストール容量こそ大きい(1〜2GB程度)ですが、<br>
インストールの手間さえ乗り越えれば、使いやすい管理ツールを使うことが出来ます。<br>
</p>
<h2>６．参考サイト</h2>
<p><a href="http://fnya.cocolog-nifty.com/blog/2009/03/sql-server-2008.html">SQL Server 2008 Express をインストール: あるＳＥのつぶやき</a></p>
<p><a href="http://awoni.net/fc/sql-server-2008-express">SQL Server 2008 Express をインストール</a></p>
<p><a href="http://gigasmegas.com/?p=599">SQL Server 2008 Express TCP/IP接続設定 | GigasMegas</a></p>
</div>
</div>
			<div id="leftpanel"> 
	
				<div align="justify" class="graypanel"> 
					<h3>アイプランニング技術情報</h3> 
					<div class="subtext" style="padding:12px;" align="justify"> 
					このページでは、アイプランニング社員が調査したこと、学んでいることが具体的にどんなものなのかを披露してきます。
					プログラム初心者の方向けの情報から、超マニアックな分野の情報まで随時提供していきますのでお楽しみ下さい。<br /> 
					<br /> 
					<a href="index.html">技術情報TOPページ</a> 
					</div> 
				</div> 
	
				<div align="justify" class="graypanel"> 
					<h3>参考サイト</h3> 
					<div class="subtext" style="padding:12px;" align="justify"> 
					<p><a href="http://fnya.cocolog-nifty.com/blog/2009/03/sql-server-2008.html">SQL Server 2008 Express をインストール: あるＳＥのつぶやき</a></p>
					<p><a href="http://awoni.net/fc/sql-server-2008-express">SQL Server 2008 Express をインストール</a></p>
					<p><a href="http://gigasmegas.com/?p=599">SQL Server 2008 Express TCP/IP接続設定 | GigasMegas</a></p>

					</div> 
				</div> 
	
				<div align="justify" class="graypanel"> 
					<h3>プログラマ募集中・・・</h3> 
					<div class="subtext" style="padding:12px;" align="justify"> 
					<b>■</b><span class="underline">第一は「人物重視」</span><br /> 
					お客さまの立場に立ってモノが作れる判断力、企画力、コンサルティング能力を磨きたくはありませんか？プログラム能力は、プロジェクトを通じて自然と能力があがるようなシステムになっています。初心者プログラマであっても３年程度で、その能力は初心者だったとは思えないくらいのスキルとなっています。<br /> 
					これは、「最初は誰でも初心者だ」という教育方針があるため、また、多くの社員が入社して初めてプログラミングにふれたという経験があるために自分のつまづき体験や、成功体験を含めた教育がなされているからなのです。<br /> 
					このようにアイプランニングでは、社員１人ひとりの個性と人間性を重視し、スキルにあったマンツーマン教育であなたを一人前のエンジニアへと成長させていきます。
					それは誠実なスタッフが集まっているからこそ、どんなお客様からも信頼される企業に成長できるから。私たちはそう考えています。
					</div> 
					<div class="subtext" style="padding:12px;" align="justify"> 
					<b>■</b><span class="underline">応募者へのメッセージ</span><br /> 
					プログラマを目指して会社に入ったものの、思った通りの仕事をさせてもらえなかったと思っている人、教育システムが十分でなかったためにスキルが身に付いていないと思っている人も気軽にご応募ください。パソコンのスキルに自信のない方でも、マンツーマンの研修制度で一人前に成長できるフィールドを整えておりますので安心してご応募くださいね。<br /> 
					知識だけでなく本当の開発力が身につく環境でのシステム開発でみつかる『やりがい』はもちろん、プライベートでも今までになかった充実感が得られますよ。<br /> 
					<ul> 
					<li><a href="../recruit/new.html">⇒新卒応募ページはこちら</a></li> 
					<li><a href="../recruit/tyuto.html">⇒中途応募ページはこちら</a></li> 
					</ul> 
					</div> 
	
				</div> 
			</div> 
	
			<div id="footer" class="smallgraytext"> 
				<a href="../index.html">HOME</a> | <a href="../outline/index.html">会社概要</a> | <a href="../policy/index.html">企業理念</a> | <a href="../product/index.html">開発実績</a> | <a href="../map/index.html">所在地(地図)</a> | <a href="../item/index.html">技術情報</a> 
				| 株式会社 アイプランニング 
				&copy; 1987 
			</div> 
		</div> 
	<script type="text/javascript"> 
	var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
	document.write("\<script src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'>\<\/script>" );
	</script> 
	<script type="text/javascript"> 
	var pageTracker = _gat._getTracker("UA-3244420-1");
	pageTracker._initData();
	pageTracker._trackPageview();
	</script> 
	</div> 

</body></html>
